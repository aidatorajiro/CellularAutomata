# 端からセルまでのオフセット
$A$11: $A$12−COLUMNS(INDIRECT(CONCATENATE("$1:$", ROWS($A))),1)+1

# セルの横の長さ
$A$12: COLUMNS(INDIRECT(CONCATENATE("$1:$", ROWS($A))))

# セルのプログラム(N6)
CELL: IF(OR(COLUMN(セル番地)=$A$11,COLUMN(セル番地)=$A$12,IFERROR(M5="X",TRUE),IFERROR(O5="X",TRUE)),"X",IF(AND(M5=0,N5=0,O5=0),$C$2,IF(AND(M5=0,N5=0,O5=1),$C$3,IF(AND(M5=0,N5=1,O5=0),$C$4,IF(AND(M5=0,N5=1,O5=1),$C$5,IF(AND(M5=1,N5=0,O5=0),$C$6,IF(AND(M5=1,N5=0,O5=1),$C$7,IF(AND(M5=1,N5=1,O5=0),$C$8,IF(AND(M5=1,N5=1,O5=1),$C$9,0)))))))))